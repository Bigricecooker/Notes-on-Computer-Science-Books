## 套接字类型与协议


创建套接字
```c
#include <sys/socket.h>

int socket(int domain, int type, int protocol);
//上述函数执行执行成功时返回文件描述符，失败时返回-1

/***
  关于函数参数
	domain 套接字中使用的协议族（Prototol Family）信息。
	type 套接字数据传输类型信息
	protocol 计算机间通信使用的协议信息
***/
```

### 协议族
套接字通信中的协议有很多分类，每一种分类称为一个协议族。

头文件 <sys/socket.h>中声明的协议族
| 名称      | 协议族               |
| --------- | -------------------- |
| PF_INET   | IPv4互联网协议族     |
| PF_INET6  | IPv6互联网协议族     |
| PF_LOCAL  | 本地通信的UNIX协议族 |
| PF_PACKET | 底层套接字的协议族   |
| PF_IPX    | IPX Novell协议族     |

一般使用的都是IPv4,其他协议族不常见


### 套接字类型
#### 面向连接的套接字(SOCK_STREAM)
向socket函数的第二个参数传递SOCK_STREAM

**特点**

1.传输过程数据不会消失

2.按序传输数据

3.传输的数据不存在数据边界

4.套接字的连接必须一一对应

收发数据的套接字内部有缓冲,简而言之就是字节数组.通过套接字传输的数据将保存到该数组,因此受到数据并不意味着马上调用read函数.只要不超过数组容量，则有可能在数据填充满缓冲后==通过一次read函数调用读取全部，也可以分成多次read函数调用进行读取.
所以在面向连接的套接字中,read函数和write函数的调用次数并无太大意义

**总结**

可靠的，按序传递的，基于字节的面向连接的数据传输方式的套接字


#### 面向消息的套接字(SOCK_DGRAM)
向socket函数的第二个参数传递SOCK_STREAM

**特点**

1.强调快速传输而非传输顺序

2.传输的数据可能丢失也可能损毁

3.传输的数据有数据边界

4.限制每次传输的数据大小

**总结**

不可靠的，不按序传递的，以数据的高速传输为目的的套接字.同时面向消息的套接字不存在连接的概念


### 协议的最终选择

大部分情况下,传递前两个参数即可创建套接字了,所以可以向第三个参数传递0,除非遇到同一协议族中存在多个数据传输方式相同的协议,此时需要需要通过第三个参数具体指定协议信息



1.参数PF_INET指IPv4网络协议族,SOCK_STREAM是面向连接的数据传输，满足这两个条件的协议只有IPPROTO_TCP,这种套接字被称为TCP套接字

```c
int udp_socket = socket(PF_INET, SOCK_STREAM, IPPROTO_UDP);
```

2.参数PF_INET指IPv4网络协议族,SOCK_DGRAM是面向消息的数据传输方式，满足这两个条件的协议只有IPPROTO_UDP,这种套接字被称为UDP套接字

```c
 int udp_socket = socket(PF_INET, SOCK_STREAM, IPPROTO_UDP);
```
